#!/bin/bash -e

if [[ -z $1 ]]; then
    echo "usage: $0 EXPERIMENT_DIR"
    exit -1
fi

readonly SCRIPT_FILEPATH=$(readlink -e ${BASH_SOURCE[0]})
readonly SCRIPT_DIRPATH=$(dirname $SCRIPT_FILEPATH)
source $SCRIPT_DIRPATH/experiment_common.sh

create_experiment_set_variables $1

echo "initializing: " $EXTERNAL_DRIVE/$RESULTS_DIR
mkdir -p $EXTERNAL_DRIVE/$RESULTS_DIR
mkdir -p $EXTERNAL_DRIVE/$RESULTS_DIR/capture-frames
mkdir -p $EXTERNAL_DRIVE/$RESULTS_DIR/playback-frames
touch $EXTERNAL_DRIVE/$RESULTS_DIR/$EXPERIMENT_VIDEO_NAME.capture.raw

echo "initializing: " $EXPERIMENT_DIR
mkdir $EXPERIMENT_DIR
ln -s $EXTERNAL_DRIVE/$RESULTS_DIR/capture-frames $EXPERIMENT_DIR
ln -s $EXTERNAL_DRIVE/$RESULTS_DIR/playback-frames $EXPERIMENT_DIR
ln -s $EXTERNAL_DRIVE/$RESULTS_DIR/$EXPERIMENT_VIDEO_NAME.capture.raw $EXPERIMENT_DIR
ln -s $INTERNAL_DRIVE/$EXPERIMENT_VIDEO_NAME.playback.raw $EXPERIMENT_DIR

